<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Settings and Help</title>
    <style>
      :root {
        --primary-color: #4a90e2;
        --primary-color-dark: #357abd;
        --success-color: #10b981;
        --error-color: #ef4444;
        --background-color: #f0f4fa;
        --text-color: #222;
        --card-background: #e9f2fe;
        --shadow-light: rgba(74, 144, 226, 0.25);
        --shadow-strong: rgba(74, 144, 226, 0.45);
        --font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      }

      body {
        font-family: var(--font-family);
        padding: 20px;
        background-color: var(--background-color);
        color: var(--text-color);
        transition: background-color 0.3s, color 0.3s;
        user-select: none;
        margin: 0;
        display: flex;
        flex-direction: column;
        justify-content: flex-start;
        align-items: center;
        min-height: 100vh;
      }
      body.dark {
        background-color: #121212;
        color: #eee;
      }

      .logo {
        width: 100%;
        max-width: 520px;
        margin: 20px auto 10px;
        font-family: var(--font-family);
        font-weight: 900;
        font-size: 2.2rem;
        color: var(--primary-color-dark);
        user-select: none;
        text-align: center;
        letter-spacing: 2px;
        text-shadow: 0 2px 10px var(--shadow-light);
        line-height: 1.2;
      }
      body.dark .logo {
        color: #4a90e2;
        text-shadow: 0 2px 10px rgba(74, 144, 226, 0.5);
      }

      main.container {
        width: 100%;
        max-width: 520px;
      }

      h2 {
        margin-top: 0;
        color: var(--primary-color-dark);
        user-select: text;
        text-align: center;
        margin-bottom: 30px;
      }

      .settings,
      .help,
      .contact {
        max-width: 100%;
        margin: 0 auto 30px auto;
        border: 1.5px solid var(--primary-color);
        border-radius: 10px;
        padding: 22px 20px 24px;
        background-color: var(--card-background);
        box-shadow: 0 8px 20px var(--shadow-light);
        box-sizing: border-box;
      }
      body.dark .settings,
      body.dark .help,
      body.dark .contact {
        background-color: #1e1e1e;
        border-color: #444;
      }

      label {
        display: block;
        margin: 18px 0 6px;
        font-weight: 700;
        color: var(--primary-color-dark);
        user-select: text;
      }

      select,
      input[type="text"],
      input[type="email"],
      textarea {
        width: 100%;
        padding: 12px;
        border-radius: 7px;
        border: 1.5px solid #a8b9d9;
        box-sizing: border-box;
        font-size: 1rem;
        font-family: var(--font-family);
        color: var(--text-color);
        transition: border-color 0.25s;
        resize: vertical;
      }
      select:focus,
      input[type="text"]:focus,
      input[type="email"]:focus,
      textarea:focus {
        outline: none;
        border-color: var(--primary-color-dark);
        box-shadow: 0 0 10px var(--shadow-light);
        background-color: #f8fbff;
      }

      button {
        background-color: var(--primary-color);
        color: white;
        font-weight: 700;
        border: none;
        padding: 12px 18px;
        font-size: 1rem;
        border-radius: 8px;
        cursor: pointer;
        margin-top: 20px;
        box-shadow: 0 5px 15px var(--shadow-light);
        transition: background-color 0.3s ease, box-shadow 0.3s ease;
        user-select: auto;
        display: block;
        width: 100%;
      }
      button:hover,
      button:focus {
        background-color: var(--primary-color-dark);
        box-shadow: 0 7px 20px var(--shadow-strong);
        outline: none;
      }

      button:disabled {
        background-color: #9ca3af;
        cursor: not-allowed;
        box-shadow: none;
        opacity: 0.7;
      }

      .modal {
        display: none;
        position: fixed;
        z-index: 999;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.65);
        justify-content: center;
        align-items: center;
      }
      .modal-content {
        background: white;
        border-radius: 12px;
        max-width: 620px;
        max-height: 75vh;
        overflow-y: auto;
        padding: 28px 28px 26px;
        box-sizing: border-box;
        user-select: text;
      }
      body.dark .modal-content {
        background: #2a2a2a;
        color: #ddd;
      }

      .modal-header {
        font-size: 1.6rem;
        margin-bottom: 14px;
        font-weight: 800;
        color: var(--primary-color-dark);
      }

      .modal-close {
        float: right;
        font-weight: 700;
        cursor: pointer;
        font-size: 1.3rem;
        user-select: none;
        color: var(--primary-color-dark);
        transition: color 0.3s ease;
      }
      .modal-close:hover,
      .modal-close:focus {
        color: var(--primary-color);
        outline: none;
      }

      /* Form feedback styles */
      .form-message {
        padding: 12px 16px;
        border-radius: 8px;
        margin-top: 12px;
        font-weight: 500;
        display: none;
      }
      .form-message.success {
        background-color: #d1fae5;
        color: var(--success-color);
        border: 1px solid #a7f3d0;
      }
      .form-message.error {
        background-color: #fee2e2;
        color: var(--error-color);
        border: 1px solid #fecaca;
      }

      /* Loading spinner */
      .loading {
        display: inline-block;
        width: 20px;
        height: 20px;
        border: 3px solid rgba(255, 255, 255, 0.3);
        border-radius: 50%;
        border-top-color: #fff;
        animation: spin 1s ease-in-out infinite;
        margin-right: 8px;
      }
      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      @media (max-width: 480px) {
        body {
          padding: 10px;
        }
        .logo {
          font-size: 1.8rem;
          margin: 15px auto 8px;
        }
        .settings,
        .help,
        .contact {
          padding: 20px 16px;
        }
      }
    </style>
  </head>
  <body>
    <!-- ✅ NEW TEXT LOGO AT TOP -->
    <div class="logo">NeuroSymbolic AI Tutor</div>

    <main class="container">
      <h2>Settings and Help</h2>

      <section class="settings">
        <h2>Settings</h2>
        <label for="theme-select">Theme:</label>
        <select id="theme-select" aria-label="Select site theme">
          <option value="light">Light</option>
          <option value="dark">Dark</option>
        </select>

        <label for="font-size-select">Font Size:</label>
        <select id="font-size-select" aria-label="Select font size">
          <option value="small">Small</option>
          <option value="medium" selected>Medium</option>
          <option value="large">Large</option>
        </select>
      </section>

      <section class="help">
        <h2>Help Guide</h2>
        <button id="open-help-btn" aria-haspopup="dialog">
          What is NeuroSymbolic AI?
        </button>

        <div
          id="help-modal"
          class="modal"
          role="dialog"
          aria-modal="true"
          aria-labelledby="help-title"
          tabindex="-1"
        >
          <div class="modal-content">
            <span
              class="modal-close"
              id="close-help-btn"
              role="button"
              aria-label="Close help dialog"
              >&times;</span
            >
            <h3 id="help-title" class="modal-header">
              NeuroSymbolic AI Explained
            </h3>
            <p>
              NeuroSymbolic AI is a powerful approach that combines neural
              networks' ability to learn patterns from data with symbolic
              reasoning's logical structure. This hybrid lets intelligent
              systems learn while providing clear, interpretable explanations,
              perfect for tutoring complex STEM concepts.
            </p>
            <p>
              In this system, neural networks handle flexible understanding like
              recognizing student input patterns, and symbolic logic applies
              rules, formulas, and step-by-step reasoning to generate
              explainable guidance.
            </p>
          </div>
        </div>
      </section>

      <section class="contact">
        <h2>Contact Support</h2>
        <form id="contact-form">
          <label for="name-input">Name:</label>
          <input
            type="text"
            id="name-input"
            name="name"
            placeholder="Your full name"
            required
            maxlength="100"
          />

          <label for="email-input">Email:</label>
          <input
            type="email"
            id="email-input"
            name="email"
            placeholder="your.email@example.com"
            required
          />

          <label for="message-textarea">Message:</label>
          <textarea
            id="message-textarea"
            name="message"
            rows="5"
            placeholder="Describe your issue or question..."
            required
            maxlength="1000"
          ></textarea>

          <div id="form-message" class="form-message" role="alert"></div>
          <button type="submit" id="submit-btn">Send Message</button>
        </form>
      </section>
    </main>

    <!-- ✅ EmailJS SDK - ACTIVATED -->
    <script
      type="text/javascript"
      src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"
    ></script>
    <script type="text/javascript">
      // ✅ Your Public Key
      emailjs.init("GK1KSo3rSzH0WXvFA");
    </script>

    <script>
      // ✅ Your Email Configuration
      const YOUR_EMAIL = "dinakarsri111@gmail.com";

      // Initialize settings from localStorage or defaults
      const themeSelect = document.getElementById("theme-select");
      const fontSizeSelect = document.getElementById("font-size-select");

      function applySettings() {
        const theme = localStorage.getItem("nsai-theme") || "light";
        const fontSize = localStorage.getItem("nsai-fontsize") || "medium";

        document.body.classList.toggle("dark", theme === "dark");

        if (fontSize === "small") {
          document.body.style.fontSize = "14px";
        } else if (fontSize === "medium") {
          document.body.style.fontSize = "16px";
        } else if (fontSize === "large") {
          document.body.style.fontSize = "18px";
        }

        themeSelect.value = theme;
        fontSizeSelect.value = fontSize;
      }

      themeSelect.addEventListener("change", () => {
        const chosenTheme = themeSelect.value;
        localStorage.setItem("nsai-theme", chosenTheme);
        applySettings();
      });

      fontSizeSelect.addEventListener("change", () => {
        const chosenFontSize = fontSizeSelect.value;
        localStorage.setItem("nsai-fontsize", chosenFontSize);
        applySettings();
      });

      // Modal Help logic
      const helpModal = document.getElementById("help-modal");
      const openHelpBtn = document.getElementById("open-help-btn");
      const closeHelpBtn = document.getElementById("close-help-btn");

      openHelpBtn.addEventListener("click", () => {
        helpModal.style.display = "flex";
        helpModal.focus();
      });

      closeHelpBtn.addEventListener("click", () => {
        helpModal.style.display = "none";
        openHelpBtn.focus();
      });

      window.addEventListener("click", (e) => {
        if (e.target === helpModal) {
          helpModal.style.display = "none";
          openHelpBtn.focus();
        }
      });

      window.addEventListener("keydown", (e) => {
        if (e.key === "Escape" && helpModal.style.display === "flex") {
          helpModal.style.display = "none";
          openHelpBtn.focus();
        }
      });

      // ✅ CONTACT FORM - ALL LOGIC PRESERVED
      const contactForm = document.getElementById("contact-form");
      const submitBtn = document.getElementById("submit-btn");
      const formMessage = document.getElementById("form-message");

      contactForm.addEventListener("submit", async function (e) {
        e.preventDefault();

        // Step 1: Validate form
        const formData = new FormData(contactForm);
        const name = document.getElementById("name-input").value.trim();
        const email = document.getElementById("email-input").value.trim();
        const message = document
          .getElementById("message-textarea")
          .value.trim();

        if (!name || !email || !message) {
          showMessage("Please fill in all fields.", "error");
          return;
        }

        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!emailRegex.test(email)) {
          showMessage("Please enter a valid email address.", "error");
          return;
        }

        // Step 2: Show loading state
        submitBtn.disabled = true;
        submitBtn.innerHTML = '<span class="loading"></span>Sending...';
        formMessage.style.display = "none";

        try {
          // ✅ STEP 3: EmailJS with YOUR CONFIGURATION
          await emailjs.send("service_mjvwu18", "template_jl3lj0m", {
            from_name: name,
            from_email: email,
            message: message,
            to_email: YOUR_EMAIL, // Sends TO your personal email
          });

          // Success!
          showMessage(
            "✅ Message sent successfully! We'll reply within 24 hours.",
            "success"
          );
          contactForm.reset();
        } catch (error) {
          console.error("EmailJS error:", error);
          showMessage(
            "❌ Failed to send message. Please try again or email support directly.",
            "error"
          );
        } finally {
          submitBtn.disabled = false;
          submitBtn.innerHTML = "Send Message";
        }
      });

      function showMessage(text, type) {
        formMessage.textContent = text;
        formMessage.className = `form-message ${type}`;
        formMessage.style.display = "block";

        // Auto-hide success messages
        if (type === "success") {
          setTimeout(() => {
            formMessage.style.display = "none";
          }, 5000);
        }
      }

      // Apply saved settings on page load
      applySettings();
    </script>
  </body>
</html>
